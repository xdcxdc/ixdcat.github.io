!function(e,t){var n=t.body,a=t.querySelector.bind(t),o=t.querySelectorAll.bind(t),s=a("html"),r=a("#gotop"),l=a("#menu"),c=a("#header"),d=a("#mask"),f=a("#menu-toggle"),u=a("#menu-off"),h=a("#loading"),v=e.requestAnimationFrame,g=Array.prototype.forEach,L="ontouchstart"in e&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",m=function(){},p=function(e){var t=e.offsetLeft,n=e.offsetTop;if(e.offsetParent){var i=arguments.callee(e.offsetParent);t+=i.x,n+=i.y}return{x:t,y:n}},y=navigator.userAgent.indexOf("Firefox")!==-1?t.documentElement:n,w={goTop:function(){var e=y.scrollTop;e>400?(y.scrollTop=e-400,v(arguments.callee)):y.scrollTop=0},toggleGotop:function(t){t>e.innerHeight/2?r.classList.add("in"):r.classList.remove("in")},toggleMenu:function(t){t?(l.classList.remove("hide"),e.innerWidth<1241&&(d.classList.add("in"),l.classList.add("show"),s.classList.add("lock"))):(l.classList.remove("show"),d.classList.remove("in"),s.classList.remove("lock"))},fixedHeader:function(e){e>c.clientHeight?c.classList.add("fixed"):c.classList.remove("fixed")},fixedToc:function(){function t(t){for(i=0,len=d.length;i<len;i++)if(t>p(d[i]).y-l){n.querySelector("li.active").classList.remove("active");var a=n.querySelector('a[href="#'+d[i].id+'"]').parentNode;a.classList.add("active"),a.offsetTop>=n.clientHeight-l?n.scrollTop=a.offsetTop-n.clientHeight+parseInt(e.innerHeight/3):n.scrollTop=0}t<p(d[0]).y&&(n.querySelector("li.active").classList.remove("active"),n.querySelector('a[href="#'+d[0].id+'"]').parentNode.classList.add("active"))}var n=a("#post-toc");if(!n||!n.children.length)return m;var s=p(n),r=s.y,l=c.clientHeight,d=a("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return n.querySelector('a[href="#'+d[0].id+'"]').parentNode.classList.add("active"),g.call(o('a[href^="#"]'),function(e){e.addEventListener("click",function(e){e.preventDefault(),y.scrollTop=p(a('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-l+10})}),function(e){e>r-l?n.classList.add("fixed"):n.classList.remove("fixed"),t(e)}}(),modal:function(e){function n(e){i.$modal.contains(e.target)||i.hide()}this.$modal=a(e),this.$off=this.$modal.querySelector(".close");var i=this;this.show=function(){d.classList.add("in"),i.$modal.classList.add("ready"),setTimeout(function(){i.$modal.classList.add("in"),t.addEventListener(L,n)},0)},this.hide=function(){d.classList.remove("in"),i.$modal.classList.remove("in"),setTimeout(function(){i.$modal.classList.remove("ready"),t.removeEventListener(L,n)},300)},this.toggle=function(){return i.$modal.classList.contains("in")?i.hide():i.show()},this.$off&&this.$off.addEventListener(L,this.hide)},share:function(){var e=a("#pageShare"),n=a("#shareFab"),i=new this.modal("#globalShare");a("#menuShare").addEventListener(L,i.toggle),n&&(n.addEventListener(L,function(){e.classList.toggle("in")},!1),t.addEventListener(L,function(t){!n.contains(t.target)&&e.classList.remove("in")},!1));var s=new this.modal("#wxShare");g.call(o(".wxFab"),function(e){e.addEventListener(L,s.toggle)})},search:function(){function e(){t.classList.toggle("in")}var t=a("#search-wrap");a("#search").addEventListener(L,e)},reward:function(){var e=new this.modal("#reward");a("#rewardBtn").addEventListener(L,e.toggle)},fixNavMinH:function(){function e(){t.style.minHeight=t.parentNode.clientHeight-t.nextElementSibling.offsetHeight+"px"}var t=a(".nav");return e}(),waterfall:function(){if(!(e.innerWidth<760)){var t=o(".waterfall");g.call(t,function(e){var t=e.querySelectorAll(".waterfall-item"),n=[0,0];g.call(t,function(e){var t=n[0]<=n[1]?0:1;e.style.cssText="top:"+n[t]+"px;left:"+(t>0?"50%":0),n[t]+=e.offsetHeight}),e.style.height=Math.max(n[0],n[1])+"px",e.classList.add("done")})}},tabBar:function(e){e.parentNode.parentNode.classList.toggle("expand")}};e.addEventListener("load",function(){w.fixNavMinH(),w.waterfall(),h.classList.remove("active")}),e.addEventListener("resize",function(){e.BLOG.even=L="ontouchstart"in e?"touchstart":"click",w.fixNavMinH(),w.toggleMenu(),w.waterfall()}),r.addEventListener(L,function(){v(w.goTop)},!1),f.addEventListener(L,function(e){w.toggleMenu(!0),e.preventDefault()},!1),u.addEventListener(L,function(){l.classList.add("hide")},!1),d.addEventListener(L,function(){w.toggleMenu()},!1),t.addEventListener("scroll",function(){var e=y.scrollTop;w.toggleGotop(e),w.fixedHeader(e),w.fixedToc(e)},!1),e.BLOG.SHARE&&w.share(),e.BLOG.REWARD&&w.reward(),w.docEl=y,w.noop=m,w.even=L,w.$=a,w.$$=o,Object.keys(w).reduce(function(e,t){return e[t]=w[t],e},e.BLOG),Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])}(window,document);